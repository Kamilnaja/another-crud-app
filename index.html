<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <style>
    /* dla uproszczenia style w head */
    body {
      text-transform: uppercase;
      background-color: darkolivegreen;
      color: burlywood;
      font-family: Calibri;
      font-size: 20px;
      padding-left: 50px;
    }
    ul li {
      cursor: pointer;
    }
    #closeBtn {
      display: inline-block;
      margin-left: 20px;
      cursor: pointer;
    }
    h1 {
      max-width: 50%;
    }
  </style>
</head>
<body>
<div>
  <h1>Aplikacja CRUD - umożliwia wyświetlanie, dodawanie, edytowanie i usuwanie elementów. </h1>
<ul id="list">

</ul>
  <input type="text" id="addInput">
  <button id="addBtn">Add</button>
  <script>
_ = function (id) {
    return document.getElementById(id);
};
var app = {
    items: ['1', '2', '3'],

    displayItem: function () {
        var data = "";

        for (var i = 0; i < this.items.length; i++) {
            data += '<li id=' + this.items[i] +'>' + this.items[i] + '</li>';
        }
        _('list').innerHTML = data;
    },

    addItem: function () {
        var newItem = document.createElement('li');
        newItem.innerHTML = _('addInput').value;
        newItem.id = newItem.innerHTML;
        _('list').appendChild(newItem);
        _('addInput').value = "";
    },

    editItem: function (e) {
      //dodaj input
        //jeśli element nie ma inputa to dodaj
        function insertAfter(referenceNode, newNode) {
            referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
        }
        var editInput = document.createElement('input');
            editInput.placeholder = 'edytuj';
            editInput.id = 'editInput';
            var editSubmit = document.createElement('button');
            //stwórz btn do potwierdzenia zmian
            editSubmit.innerHTML = "Edytuj";
            editSubmit.id = 'editSubmit';
            var elementToEdit = document.getElementById(e.target.id);

        insertAfter(elementToEdit, editInput);
        insertAfter(elementToEdit, editSubmit);
            //pobierz wartość inputa i wrzuć ją do elementu


        checkAndEdit = function () {
            _('list').removeEventListener('click', app.editItem);

            if (editInput.value.length !== 0) {
                e.target.innerHTML = editInput.value;
            } else {
                console.log("wpisz coś");
            }
            console.log('succes');
        }
    },

    deleteItem: function (e) {
        _('list').removeEventListener('click', app.deleteItem);

        if (e.target.childNodes.length <= 1){
            var closeBtn = document.createElement('button');
            closeBtn.innerHTML = 'X';
            closeBtn.id = 'closeBtn';
            var elementToErase = _(e.target.id);
            elementToErase.appendChild(closeBtn);

            eraseElement = function () {
                if (e.target && e.target.nodeName === "LI") {
                    //dodaj zamykaczkę
                    var parent = elementToErase.parentNode;
                    parent.removeChild(elementToErase);
                }
            };
            _('closeBtn').addEventListener('click', eraseElement);
        }
    }

};

app.displayItem();
//event listeners
    _('addBtn').addEventListener('click', app.addItem);
    _('list').addEventListener('click', app.editItem);
  </script>
</div>
</body>
</html>
